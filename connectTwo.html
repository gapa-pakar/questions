<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Selection Question</title>
    <style>
        @font-face {
            font-family: "Assistant";
            src: url("assets/fonts/Assistant/Assistant-Regular.ttf");
        }

        /* General body styling */
        body {
            font-family: "Assistant", sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-size: calc(1vh + 1vw + 8px);
        }

        /* Question text styling */
        #question {
            margin-bottom: 2rem;
            font-size: 1.5rem;
            text-align: center;
        }

        /* Container for the cards */
        .card-container {
            display: flex;
            flex-direction: column; /* Organize in two horizontal rows */
            align-items: center;
            width: 80%;
        }

        /* Year and Event container styling */
        .year-container, .event-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        /* Card default styling */
        .card {
            width: 10rem;
            height: 5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.5);
            border: 2px solid white;
            border-radius: 0.5rem;
            cursor: pointer;
            text-align: center;
            font-size: 1rem;
            padding: 0.5rem;
            margin: 0.5rem; /* Space between cards */
        }

        /* Selected card */
        .selected {
            background-color: rgba(103, 169, 255, 0.5);
            border-color: rgba(103, 169, 255, 0.5);
        }

        /* Correctly selected answer */
        .correct {
            background-color: rgba(61, 223, 115, 0.5);
            border-color: rgb(61, 223, 115);
        }

        /* Incorrectly selected answer */
        @keyframes blink {
            0%, 100% { background-color: rgba(252, 90, 90, 0.5); border-color: rgb(252, 90, 90); }
            50% { background-color: rgba(255, 255, 255, 0.5); border-color: white; }
        }

        .wrong {
            animation: blink 0.75s ease-in-out 3;
        }

        /* Check button styling */
        #check-btn {
            font-family: "Assistant", sans-serif;
            font-weight: 600;
            border: 2px solid white;
            border-radius: 3rem;
            background-color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
            padding: 0.5rem 1.5rem;
            margin-top: 1rem;
            cursor: pointer;
        }

        /* Error message styling */
        .error {
            color: red;
            font-size: 1rem;
            margin-top: 1rem;
            display: none;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="question">התאם בין התאריך לאירוע. לחץ על 2 תשובות משורות שונות ולחץ על כפתור "חבר" כדי לבדוק את תשובתך</div>

    <!-- Card Container -->
    <div class="card-container">
        <!-- Year Cards (First Row) -->
        <div class="year-container">
            <div id="year1" class="card">1992</div>
            <div id="year2" class="card">2003</div>
            <div id="year3" class="card">2004</div>
            <div id="year4" class="card">2008</div>
            <div id="year5" class="card">2009</div>
            <div id="year6" class="card">2012</div>
            <div id="year7" class="card">2012</div>
            <div id="year8" class="card">2013</div>
            <div id="year9" class="card">2016</div>
        </div>

        <!-- Shuffled Event Cards (Second Row) -->
        <div class="event-container">
            <div id="event6" class="card">הקמת גדוד תבור</div>
            <div id="event2" class="card">הקמת פלוגת החילוץ הראשונה- פלוגת 'שביט'</div>
            <div id="event8" class="card">הקמת הנפה הסדירה</div>
            <div id="event3" class="card">הקמת פלוגת 'חץ' ופלוגת 'רותם'</div>
            <div id="event9" class="card">איחוד בה"ד 16 והנפה הסדירה והקמת חטיבת החילוץ</div>
            <div id="event5" class="card">הקמת גדוד קדם</div>
            <div id="event1" class="card">הקמת פיקוד העורף</div>
            <div id="event7" class="card">הקמת גדוד רם</div>
            <div id="event4" class="card">איחוד פלוגות החילוץ והקמת גדוד שחר</div>
        </div>
    </div>

    <!-- Connect Button -->
    <button id="check-btn">חבר</button>

    <!-- Error Message -->
    <div class="error" id="error-msg">עליכם לבחור 2 תשובות בלבד</div>

    <script>
        let selectedCards = [];

        const correctPairs = {
            'year1': 'event1',
            'year2': 'event2',
            'year3': 'event3',
            'year4': 'event4',
            'year5': 'event5',
            'year6': ['event6', 'event7'],
            'year7': ['event6', 'event7'],
            'year8': 'event8',
            'year9': 'event9'
        };

        let allCorrectPairsMatched = 0;

        // Handle card selection and deselection
        function handleSelectedAnswerCards(card, container) {
            const selectedCard = container.querySelector('.selected');

            // Deselect the currently selected card if clicked again
            if (card.classList.contains('selected')) {
                card.classList.remove('selected');
                selectedCards = selectedCards.filter(c => c !== card);
            } else {
                // If there is another selected card in the same container, deselect it
                if (selectedCard) {
                    selectedCard.classList.remove('selected');
                    selectedCards = selectedCards.filter(c => c !== selectedCard);
                }
                // Select the clicked card
                card.classList.add('selected');
                selectedCards.push(card);
            }
        }

        // Check the selected answer cards
        function checkAnswerCards() {
            const checkBtn = document.getElementById('check-btn');
            const errorMsg = document.getElementById('error-msg');

            // Ensure exactly two cards are selected
            if (selectedCards.length !== 2) {
                errorMsg.style.display = 'block';
                setTimeout(() => errorMsg.style.display = 'none', 10000);
                // Deselect the cards after showing the error
                selectedCards.forEach(card => card.classList.remove('selected'));
                selectedCards = [];
                return;
            }

            const [yearCard, eventCard] = selectedCards;
            const yearId = yearCard.id;
            const eventId = eventCard.id;
            const isCorrectPair = Array.isArray(correctPairs[yearId])
                ? correctPairs[yearId].includes(eventId)
                : correctPairs[yearId] === eventId;

            if (isCorrectPair) {
                // Mark correct pair and lock them
                yearCard.classList.add('correct');
                eventCard.classList.add('correct');
                yearCard.classList.remove('selected');
                eventCard.classList.remove('selected');
                selectedCards = [];
                allCorrectPairsMatched++;

                // Check if all pairs are matched
                if (allCorrectPairsMatched === 9) {
                    checkBtn.textContent = 'הבא';
                }
            } else {
                // Animate wrong answer (blinking effect)
                yearCard.classList.add('wrong');
                eventCard.classList.add('wrong');
                setTimeout(() => {
                    yearCard.classList.remove('wrong');
                    eventCard.classList.remove('wrong');
                    yearCard.classList.remove('selected');
                    eventCard.classList.remove('selected');
                    selectedCards = [];
                }, 1500);
            }
        }

        // Get the year and event containers
        const yearContainer = document.querySelector('.year-container');
        const eventContainer = document.querySelector('.event-container');

        // Add event listeners for year cards
        yearContainer.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', () => {
                handleSelectedAnswerCards(card, yearContainer);
            });
        });

        // Add event listeners for event cards
        eventContainer.querySelectorAll('.card').forEach(card => {
            card.addEventListener('click', () => {
                handleSelectedAnswerCards(card, eventContainer);
            });
        });

        // Add event listener for the check button
        document.getElementById('check-btn').addEventListener('click', () => {
            if (allCorrectPairsMatched === 9) {
                alert('finished question');
            } else {
                checkAnswerCards();
            }
        });
    </script>
</body>
</html>
